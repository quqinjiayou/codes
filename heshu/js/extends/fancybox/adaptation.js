define(function(){var f,d="maxWidth"in document.documentElement.style,e=!-[1]&&!("prototype"in Image)&&d;$.fn.adaptation=function(){var a=this.width(),b=this.height();return this.css({position:"relative",overflow:"hidden",zoom:1}),this.find("img").each(function(c,d){var e=d.src;d.style.display="none",d.removeAttribute("src"),f(e,function(c,f){c>a&&(f=a/c*f,c=a,d.style.width=parseInt(c)+"px",d.style.height=parseInt(f)+"px",d.style.position="absolute",d.style.left=parseInt((a-c)/2)+"px",d.style.top=parseInt((b-f)/2)+"px"),f>b&&(_height=b,_width=c*(b/f),d.style.height=parseInt(_height)+"px",d.style.width=parseInt(_width)+"px",d.style.position="absolute",d.style.left=parseInt((a-_width)/2)+"px",d.style.top=parseInt((b-_height)/2)+"px"),d.style.display="",d.setAttribute("src",e)})})},e&&function(a,b,c){c=b.createElement("style"),b.getElementsByTagName("head")[0].appendChild(c),c.styleSheet&&(c.styleSheet.cssText+=a)||c.appendChild(b.createTextNode(a))}("img {-ms-interpolation-mode:bicubic}",document),f=function(){var a=[],b=null,c=function(){for(var b=0;b<a.length;b++)a[b].end?a.splice(b--,1):a[b]();!a.length&&d()},d=function(){clearInterval(b),b=null};return function(d,e,f,g){var h,i,j,k,l,m=new Image;return m.src=d,m.complete?(e(m.width,m.height),f&&f(m.width,m.height),void 0):(i=m.width,j=m.height,h=function(){k=m.width,l=m.height,(k!==i||l!==j||k*l>1024)&&(e(k,l),h.end=!0)},h(),m.onerror=function(){g&&g(),h.end=!0,m=m.onload=m.onerror=null},m.onload=function(){f&&f(m.width,m.height),!h.end&&h(),m=m.onload=m.onerror=null},h.end||(a.push(h),null===b&&(b=setInterval(c,40))),void 0)}}()});