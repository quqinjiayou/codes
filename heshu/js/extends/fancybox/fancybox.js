define(function(){"use strict";var d=$("html"),e=$(window),f=$(document),g=$.fancybox=function(){g.open.apply(this,arguments)},h=navigator.userAgent.match(/msie/i),i=null,j=void 0!==document.createTouch,k=function(a){return a&&a.hasOwnProperty&&a instanceof $},l=function(a){return a&&"string"===$.type(a)},m=function(a){return l(a)&&a.indexOf("%")>0},n=function(a){return a&&!(a.style.overflow&&"hidden"===a.style.overflow)&&(a.clientWidth&&a.scrollWidth>a.clientWidth||a.clientHeight&&a.scrollHeight>a.clientHeight)},o=function(a,b){var c=parseInt(a,10)||0;return b&&m(a)&&(c=g.getViewport()[b]/100*c),Math.ceil(c)},p=function(a,b){return o(a,b)+"px"};$.extend(g,{version:"2.1.5",defaults:{padding:15,margin:20,width:800,height:600,minWidth:100,minHeight:100,maxWidth:9999,maxHeight:9999,pixelRatio:1,autoSize:!0,autoHeight:!1,autoWidth:!1,autoResize:!0,autoCenter:!j,fitToView:!0,aspectRatio:!1,topRatio:.5,leftRatio:.5,scrolling:"auto",wrapCSS:"",arrows:!0,closeBtn:!0,closeClick:!1,nextClick:!1,mouseWheel:!0,autoPlay:!1,playSpeed:3e3,preload:3,modal:!1,loop:!0,ajax:{dataType:"html",headers:{"X-fancyBox":!0}},iframe:{scrolling:"auto",preload:!0},swf:{wmode:"transparent",allowfullscreen:"true",allowscriptaccess:"always"},keys:{next:{13:"left",34:"up",39:"left",40:"up"},prev:{8:"right",33:"down",37:"right",38:"down"},close:[27],play:[32],toggle:[70]},direction:{next:"left",prev:"right"},scrollOutside:!0,index:0,type:null,href:null,content:null,title:null,tpl:{wrap:'<div class="fancybox-wrap" tabIndex="-1"><div class="fancybox-skin"><div class="fancybox-outer"><div class="fancybox-inner"></div></div></div></div>',image:'<img class="fancybox-image" src="{href}" alt="" />',iframe:'<iframe id="fancybox-frame{rnd}" name="fancybox-frame{rnd}" class="fancybox-iframe" frameborder="0" vspace="0" hspace="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen'+(h?' allowtransparency="true"':"")+"></iframe>",error:'<p class="fancybox-error">The requested content cannot be loaded.<br/>Please try again later.</p>',closeBtn:'<a title="Close" class="fancybox-item fancybox-close" href="javascript:;"></a>',next:'<a title="Next" class="fancybox-nav fancybox-next" href="javascript:;"><span></span></a>',prev:'<a title="Previous" class="fancybox-nav fancybox-prev" href="javascript:;"><span></span></a>'},openEffect:"fade",openSpeed:250,openEasing:"swing",openOpacity:!0,openMethod:"zoomIn",closeEffect:"fade",closeSpeed:250,closeEasing:"swing",closeOpacity:!0,closeMethod:"zoomOut",nextEffect:"elastic",nextSpeed:250,nextEasing:"swing",nextMethod:"changeIn",prevEffect:"elastic",prevSpeed:250,prevEasing:"swing",prevMethod:"changeOut",helpers:{overlay:!0,title:!0},onCancel:$.noop,beforeLoad:$.noop,afterLoad:$.noop,beforeShow:$.noop,afterShow:$.noop,beforeChange:$.noop,beforeClose:$.noop,afterClose:$.noop},group:{},opts:{},previous:null,coming:null,current:null,isActive:!1,isOpen:!1,isOpened:!1,wrap:null,skin:null,outer:null,inner:null,player:{timer:null,isActive:!1},ajaxLoad:null,imgPreload:null,transitions:{},helpers:{},open:function(a,b){return a&&($.isPlainObject(b)||(b={}),!1!==g.close(!0))?($.isArray(a)||(a=k(a)?$(a).get():[a]),$.each(a,function(c,d){var f,h,i,j,m,n,o,e={};"object"===$.type(d)&&(d.nodeType&&(d=$(d)),k(d)?(e={href:d.data("fancybox-href")||d.attr("href"),title:d.data("fancybox-title")||d.attr("title"),isDom:!0,element:d},$.metadata&&$.extend(!0,e,d.metadata())):e=d),f=b.href||e.href||(l(d)?d:null),h=void 0!==b.title?b.title:e.title||"",i=b.content||e.content,j=i?"html":b.type||e.type,!j&&e.isDom&&(j=d.data("fancybox-type"),j||(m=d.prop("class").match(/fancybox\.(\w+)/),j=m?m[1]:null)),l(f)&&(j||(g.isImage(f)?j="image":g.isSWF(f)?j="swf":"#"===f.charAt(0)?j="inline":l(d)&&(j="html",i=d)),"ajax"===j&&(n=f.split(/\s+/,2),f=n.shift(),o=n.shift())),i||("inline"===j?f?i=$(l(f)?f.replace(/.*(?=#[^\s]+$)/,""):f):e.isDom&&(i=d):"html"===j?i=f:j||f||!e.isDom||(j="inline",i=d)),$.extend(e,{href:f,type:j,content:i,title:h,selector:o}),a[c]=e}),g.opts=$.extend(!0,{},g.defaults,b),void 0!==b.keys&&(g.opts.keys=b.keys?$.extend({},g.defaults.keys,b.keys):!1),g.group=a,g._start(g.opts.index)):void 0},cancel:function(){var a=g.coming;a&&!1!==g.trigger("onCancel")&&(g.hideLoading(),g.ajaxLoad&&g.ajaxLoad.abort(),g.ajaxLoad=null,g.imgPreload&&(g.imgPreload.onload=g.imgPreload.onerror=null),a.wrap&&a.wrap.stop(!0,!0).trigger("onReset").remove(),g.coming=null,g.current||g._afterZoomOut(a))},close:function(a){g.cancel(),!1!==g.trigger("beforeClose")&&(g.unbindEvents(),g.isActive&&(g.isOpen&&a!==!0?(g.isOpen=g.isOpened=!1,g.isClosing=!0,$(".fancybox-item, .fancybox-nav").remove(),g.wrap.stop(!0,!0).removeClass("fancybox-opened"),g.transitions[g.current.closeMethod]()):($(".fancybox-wrap").stop(!0).trigger("onReset").remove(),g._afterZoomOut())))},play:function(a){var b=function(){clearTimeout(g.player.timer)},c=function(){b(),g.current&&g.player.isActive&&(g.player.timer=setTimeout(g.next,g.current.playSpeed))},d=function(){b(),f.unbind(".player"),g.player.isActive=!1,g.trigger("onPlayEnd")},e=function(){g.current&&(g.current.loop||g.current.index<g.group.length-1)&&(g.player.isActive=!0,f.bind({"onCancel.player beforeClose.player":d,"onUpdate.player":c,"beforeLoad.player":b}),c(),g.trigger("onPlayStart"))};a===!0||!g.player.isActive&&a!==!1?e():d()},next:function(a){var b=g.current;b&&(l(a)||(a=b.direction.next),g.jumpto(b.index+1,a,"next"))},prev:function(a){var b=g.current;b&&(l(a)||(a=b.direction.prev),g.jumpto(b.index-1,a,"prev"))},jumpto:function(a,b,c){var d=g.current;d&&(a=o(a),g.direction=b||d.direction[a>=d.index?"next":"prev"],g.router=c||"jumpto",d.loop&&(0>a&&(a=d.group.length+a%d.group.length),a%=d.group.length),void 0!==d.group[a]&&(g.cancel(),g._start(a)))},reposition:function(a,b){var e,c=g.current,d=c?c.wrap:null;d&&(e=g._getPosition(b),a&&"scroll"===a.type?(delete e.position,d.stop(!0,!0).animate(e,200)):(d.css(e),c.pos=$.extend({},c.dim,e)))},update:function(a){var b=a&&a.type,c=!b||"orientationchange"===b;c&&(clearTimeout(i),i=null),g.isOpen&&!i&&(i=setTimeout(function(){var d=g.current;d&&!g.isClosing&&(g.wrap.removeClass("fancybox-tmp"),(c||"load"===b||"resize"===b&&d.autoResize)&&g._setDimension(),"scroll"===b&&d.canShrink||g.reposition(a),g.trigger("onUpdate"),i=null)},c&&!j?0:300))},toggle:function(a){g.isOpen&&(g.current.fitToView="boolean"===$.type(a)?a:!g.current.fitToView,j&&(g.wrap.removeAttr("style").addClass("fancybox-tmp"),g.trigger("onUpdate")),g.update())},hideLoading:function(){f.unbind(".loading"),$("#fancybox-loading").remove()},showLoading:function(){var a,b;g.hideLoading(),a=$('<div id="fancybox-loading"><div></div></div>').click(g.cancel).appendTo("body"),f.bind("keydown.loading",function(a){27===(a.which||a.keyCode)&&(a.preventDefault(),g.cancel())}),g.defaults.fixed||(b=g.getViewport(),a.css({position:"absolute",top:.5*b.h+b.y,left:.5*b.w+b.x}))},getViewport:function(){var a=g.current&&g.current.locked||!1,b={x:e.scrollLeft(),y:e.scrollTop()};return a?(b.w=a[0].clientWidth,b.h=a[0].clientHeight):(b.w=j&&window.innerWidth?window.innerWidth:e.width(),b.h=j&&window.innerHeight?window.innerHeight:e.height()),b},unbindEvents:function(){g.wrap&&k(g.wrap)&&g.wrap.unbind(".fb"),f.unbind(".fb"),e.unbind(".fb")},bindEvents:function(){var b,a=g.current;a&&(e.bind("orientationchange.fb"+(j?"":" resize.fb")+(a.autoCenter&&!a.locked?" scroll.fb":""),g.update),b=a.keys,b&&f.bind("keydown.fb",function(c){var d=c.which||c.keyCode,e=c.target||c.srcElement;return 27===d&&g.coming?!1:(c.ctrlKey||c.altKey||c.shiftKey||c.metaKey||e&&(e.type||$(e).is("[contenteditable]"))||$.each(b,function(b,e){return a.group.length>1&&void 0!==e[d]?(g[b](e[d]),c.preventDefault(),!1):$.inArray(d,e)>-1?(g[b](),c.preventDefault(),!1):void 0}),void 0)}),$.fn.mousewheel&&a.mouseWheel&&g.wrap.bind("mousewheel.fb",function(b,c,d,e){for(var f=b.target||null,h=$(f),i=!1;h.length&&!(i||h.is(".fancybox-skin")||h.is(".fancybox-wrap"));)i=n(h[0]),h=$(h).parent();0===c||i||g.group.length>1&&!a.canShrink&&(e>0||d>0?g.prev(e>0?"down":"left"):(0>e||0>d)&&g.next(0>e?"up":"right"),b.preventDefault())}))},trigger:function(a,b){var c,d=b||g.coming||g.current;if(d){if($.isFunction(d[a])&&(c=d[a].apply(d,Array.prototype.slice.call(arguments,1))),c===!1)return!1;d.helpers&&$.each(d.helpers,function(b,c){c&&g.helpers[b]&&$.isFunction(g.helpers[b][a])&&g.helpers[b][a]($.extend(!0,{},g.helpers[b].defaults,c),d)}),f.trigger(a)}},isImage:function(a){return l(a)&&a.match(/(^data:image\/.*,)|(\.(jp(e|g|eg)|gif|png|bmp|webp|svg)((\?|#).*)?$)/i)},isSWF:function(a){return l(a)&&a.match(/\.(swf)((\?|#).*)?$/i)},_start:function(a){var c,d,e,f,h,b={};if(a=o(a),c=g.group[a]||null,!c)return!1;if(b=$.extend(!0,{},g.opts,c),f=b.margin,h=b.padding,"number"===$.type(f)&&(b.margin=[f,f,f,f]),"number"===$.type(h)&&(b.padding=[h,h,h,h]),b.modal&&$.extend(!0,b,{closeBtn:!1,closeClick:!1,nextClick:!1,arrows:!1,mouseWheel:!1,keys:null,helpers:{overlay:{closeClick:!1}}}),b.autoSize&&(b.autoWidth=b.autoHeight=!0),"auto"===b.width&&(b.autoWidth=!0),"auto"===b.height&&(b.autoHeight=!0),b.group=g.group,b.index=a,g.coming=b,!1===g.trigger("beforeLoad"))return g.coming=null,void 0;if(e=b.type,d=b.href,!e)return g.coming=null,g.current&&g.router&&"jumpto"!==g.router?(g.current.index=a,g[g.router](g.direction)):!1;if(g.isActive=!0,("image"===e||"swf"===e)&&(b.autoHeight=b.autoWidth=!1,b.scrolling="visible"),"image"===e&&(b.aspectRatio=!0),"iframe"===e&&j&&(b.scrolling="scroll"),b.wrap=$(b.tpl.wrap).addClass("fancybox-"+(j?"mobile":"desktop")+" fancybox-type-"+e+" fancybox-tmp "+b.wrapCSS).appendTo(b.parent||"body"),$.extend(b,{skin:$(".fancybox-skin",b.wrap),outer:$(".fancybox-outer",b.wrap),inner:$(".fancybox-inner",b.wrap)}),$.each(["Top","Right","Bottom","Left"],function(a,c){b.skin.css("padding"+c,p(b.padding[a]))}),g.trigger("onReady"),"inline"===e||"html"===e){if(!b.content||!b.content.length)return g._error("content")}else if(!d)return g._error("href");"image"===e?g._loadImage():"ajax"===e?g._loadAjax():"iframe"===e?g._loadIframe():g._afterLoad()},_error:function(a){$.extend(g.coming,{type:"html",autoWidth:!0,autoHeight:!0,minWidth:0,minHeight:0,scrolling:"no",hasError:a,content:g.coming.tpl.error}),g._afterLoad()},_loadImage:function(){var a=g.imgPreload=new Image;a.onload=function(){this.onload=this.onerror=null,g.coming.width=this.width/g.opts.pixelRatio,g.coming.height=this.height/g.opts.pixelRatio,g._afterLoad()},a.onerror=function(){this.onload=this.onerror=null,g._error("image")},a.src=g.coming.href,a.complete!==!0&&g.showLoading()},_loadAjax:function(){var a=g.coming;g.showLoading(),g.ajaxLoad=$.ajax($.extend({},a.ajax,{url:a.href,error:function(a,b){g.coming&&"abort"!==b?g._error("ajax",a):g.hideLoading()},success:function(b,c){"success"===c&&(a.content=b,g._afterLoad())}}))},_loadIframe:function(){var a=g.coming,b=$(a.tpl.iframe.replace(/\{rnd\}/g,(new Date).getTime())).attr("scrolling",j?"auto":a.iframe.scrolling).attr("src",a.href);$(a.wrap).bind("onReset",function(){try{$(this).find("iframe").hide().attr("src","//about:blank").end().empty()}catch(a){}}),a.iframe.preload&&(g.showLoading(),b.one("load",function(){$(this).data("ready",1),j||$(this).bind("load.fb",g.update),$(this).parents(".fancybox-wrap").width("100%").removeClass("fancybox-tmp").show(),g._afterLoad()})),a.content=b.appendTo(a.inner),a.iframe.preload||g._afterLoad()},_preloadImages:function(){var e,f,a=g.group,b=g.current,c=a.length,d=b.preload?Math.min(b.preload,c-1):0;for(f=1;d>=f;f+=1)e=a[(b.index+f)%c],"image"===e.type&&e.href&&((new Image).src=e.href)},_afterLoad:function(){var d,e,f,h,i,j,a=g.coming,b=g.current,c="fancybox-placeholder";if(g.hideLoading(),a&&g.isActive!==!1){if(!1===g.trigger("afterLoad",a,b))return a.wrap.stop(!0).trigger("onReset").remove(),g.coming=null,void 0;switch(b&&(g.trigger("beforeChange",b),b.wrap.stop(!0).removeClass("fancybox-opened").find(".fancybox-item, .fancybox-nav").remove()),g.unbindEvents(),d=a,e=a.content,f=a.type,h=a.scrolling,$.extend(g,{wrap:d.wrap,skin:d.skin,outer:d.outer,inner:d.inner,current:d,previous:b}),i=d.href,f){case"inline":case"ajax":case"html":d.selector?e=$("<div>").html(e).find(d.selector):k(e)&&(e.data(c)||e.data(c,$('<div class="'+c+'"></div>').insertAfter(e).hide()),e=e.show().detach(),d.wrap.bind("onReset",function(){$(this).find(e).length&&e.hide().replaceAll(e.data(c)).data(c,!1)}));break;case"image":e=d.tpl.image.replace("{href}",i);break;case"swf":e='<object id="fancybox-swf" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="100%" height="100%"><param name="movie" value="'+i+'"></param>',j="",$.each(d.swf,function(a,b){e+='<param name="'+a+'" value="'+b+'"></param>',j+=" "+a+'="'+b+'"'}),e+='<embed src="'+i+'" type="application/x-shockwave-flash" width="100%" height="100%"'+j+"></embed></object>"}k(e)&&e.parent().is(d.inner)||d.inner.append(e),g.trigger("beforeShow"),d.inner.css("overflow","yes"===h?"scroll":"no"===h?"hidden":h),g._setDimension(),g.reposition(),g.isOpen=!1,g.coming=null,g.bindEvents(),g.isOpened?b.prevMethod&&g.transitions[b.prevMethod]():$(".fancybox-wrap").not(d.wrap).stop(!0).trigger("onReset").remove(),g.transitions[g.isOpened?d.nextMethod:d.openMethod](),g._preloadImages()}},_setDimension:function(){var x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,a=g.getViewport(),b=0,c=!1,d=!1,e=g.wrap,f=g.skin,h=g.inner,i=g.current,j=i.width,k=i.height,l=i.minWidth,n=i.minHeight,q=i.maxWidth,r=i.maxHeight,s=i.scrolling,t=i.scrollOutside?i.scrollbarWidth:0,u=i.margin,v=o(u[1]+u[3]),w=o(u[0]+u[2]);if(e.add(f).add(h).width("auto").height("auto").removeClass("fancybox-tmp"),x=o(f.outerWidth(!0)-f.width()),y=o(f.outerHeight(!0)-f.height()),z=v+x,A=w+y,B=m(j)?(a.w-z)*o(j)/100:j,C=m(k)?(a.h-A)*o(k)/100:k,"iframe"===i.type){if(K=i.content,i.autoHeight&&1===K.data("ready"))try{K[0].contentWindow.document.location&&(h.width(B).height(9999),L=K.contents().find("body"),t&&L.css("overflow-x","hidden"),C=L.outerHeight(!0))}catch(M){}}else(i.autoWidth||i.autoHeight)&&(h.addClass("fancybox-tmp"),i.autoWidth||h.width(B),i.autoHeight||h.height(C),i.autoWidth&&(B=h.width()),i.autoHeight&&(C=h.height()),h.removeClass("fancybox-tmp"));if(j=o(B),k=o(C),F=B/C,l=o(m(l)?o(l,"w")-z:l),q=o(m(q)?o(q,"w")-z:q),n=o(m(n)?o(n,"h")-A:n),r=o(m(r)?o(r,"h")-A:r),D=q,E=r,i.fitToView&&(q=Math.min(a.w-z,q),r=Math.min(a.h-A,r)),I=a.w-v,J=a.h-w,i.aspectRatio?(j>q&&(j=q,k=o(j/F)),k>r&&(k=r,j=o(k*F)),l>j&&(j=l,k=o(j/F)),n>k&&(k=n,j=o(k*F))):(j=Math.max(l,Math.min(j,q)),i.autoHeight&&"iframe"!==i.type&&(h.width(j),k=h.height()),k=Math.max(n,Math.min(k,r))),i.fitToView)if(h.width(j).height(k),e.width(j+x),G=e.width(),H=e.height(),i.aspectRatio)for(;(G>I||H>J)&&j>l&&k>n&&!(b++>19);)k=Math.max(n,Math.min(r,k-10)),j=o(k*F),l>j&&(j=l,k=o(j/F)),j>q&&(j=q,k=o(j/F)),h.width(j).height(k),e.width(j+x),G=e.width(),H=e.height();else j=Math.max(l,Math.min(j,j-(G-I))),k=Math.max(n,Math.min(k,k-(H-J)));t&&"auto"===s&&C>k&&I>j+x+t&&(j+=t),h.width(j).height(k),e.width(j+x),G=e.width(),H=e.height(),c=(G>I||H>J)&&j>l&&k>n,d=i.aspectRatio?D>j&&E>k&&B>j&&C>k:(D>j||E>k)&&(B>j||C>k),$.extend(i,{dim:{width:p(G),height:p(H)},origWidth:B,origHeight:C,canShrink:c,canExpand:d,wPadding:x,hPadding:y,wrapSpace:H-f.outerHeight(!0),skinSpace:f.height()-k}),!K&&i.autoHeight&&k>n&&r>k&&!d&&h.height("auto")},_getPosition:function(a){var b=g.current,c=g.getViewport(),d=b.margin,e=g.wrap.width()+d[1]+d[3],f=g.wrap.height()+d[0]+d[2],h={position:"absolute",top:d[0],left:d[3]};return b.autoCenter&&b.fixed&&!a&&f<=c.h&&e<=c.w?h.position="fixed":b.locked||(h.top+=c.y,h.left+=c.x),h.top=p(Math.max(h.top,h.top+(c.h-f)*b.topRatio)),h.left=p(Math.max(h.left,h.left+(c.w-e)*b.leftRatio)),h},_afterZoomIn:function(){var a=g.current;a&&(g.isOpen=g.isOpened=!0,g.wrap.css("overflow","visible").addClass("fancybox-opened"),g.update(),(a.closeClick||a.nextClick&&g.group.length>1)&&g.inner.css("cursor","pointer").bind("click.fb",function(b){$(b.target).is("a")||$(b.target).parent().is("a")||(b.preventDefault(),g[a.closeClick?"close":"next"]())}),a.closeBtn&&$(a.tpl.closeBtn).appendTo(g.skin).bind("click.fb",function(a){a.preventDefault(),g.close()}),a.arrows&&g.group.length>1&&((a.loop||a.index>0)&&$(a.tpl.prev).appendTo(g.outer).bind("click.fb",g.prev),(a.loop||a.index<g.group.length-1)&&$(a.tpl.next).appendTo(g.outer).bind("click.fb",g.next)),g.trigger("afterShow"),a.loop||a.index!==a.group.length-1?g.opts.autoPlay&&!g.player.isActive&&(g.opts.autoPlay=!1,g.play()):g.play(!1))},_afterZoomOut:function(a){a=a||g.current,$(".fancybox-wrap").trigger("onReset").remove(),$.extend(g,{group:{},opts:{},router:!1,current:null,isActive:!1,isOpened:!1,isOpen:!1,isClosing:!1,wrap:null,skin:null,outer:null,inner:null}),g.trigger("afterClose",a)}}),g.transitions={getOrigPosition:function(){var a=g.current,b=a.element,c=a.orig,d={},e=50,f=50,h=a.hPadding,i=a.wPadding,j=g.getViewport();return!c&&a.isDom&&b.is(":visible")&&(c=b.find("img:first"),c.length||(c=b)),k(c)?(d=c.offset(),c.is("img")&&(e=c.outerWidth(),f=c.outerHeight())):(d.top=j.y+(j.h-f)*a.topRatio,d.left=j.x+(j.w-e)*a.leftRatio),("fixed"===g.wrap.css("position")||a.locked)&&(d.top-=j.y,d.left-=j.x),d={top:p(d.top-h*a.topRatio),left:p(d.left-i*a.leftRatio),width:p(e+i),height:p(f+h)}},step:function(a,b){var c,d,e,f=b.prop,h=g.current,i=h.wrapSpace,j=h.skinSpace;("width"===f||"height"===f)&&(c=b.end===b.start?1:(a-b.start)/(b.end-b.start),g.isClosing&&(c=1-c),d="width"===f?h.wPadding:h.hPadding,e=a-d,g.skin[f](o("width"===f?e:e-i*c)),g.inner[f](o("width"===f?e:e-i*c-j*c)))},zoomIn:function(){var a=g.current,b=a.pos,c=a.openEffect,d="elastic"===c,e=$.extend({opacity:1},b);delete e.position,d?(b=this.getOrigPosition(),a.openOpacity&&(b.opacity=.1)):"fade"===c&&(b.opacity=.1),g.wrap.css(b).animate(e,{duration:"none"===c?0:a.openSpeed,easing:a.openEasing,step:d?this.step:null,complete:g._afterZoomIn})},zoomOut:function(){var a=g.current,b=a.closeEffect,c="elastic"===b,d={opacity:.1};c&&(d=this.getOrigPosition(),a.closeOpacity&&(d.opacity=.1)),g.wrap.animate(d,{duration:"none"===b?0:a.closeSpeed,easing:a.closeEasing,step:c?this.step:null,complete:g._afterZoomOut})},changeIn:function(){var h,a=g.current,b=a.nextEffect,c=a.pos,d={opacity:1},e=g.direction,f=200;c.opacity=.1,"elastic"===b&&(h="down"===e||"up"===e?"top":"left","down"===e||"right"===e?(c[h]=p(o(c[h])-f),d[h]="+="+f+"px"):(c[h]=p(o(c[h])+f),d[h]="-="+f+"px")),"none"===b?g._afterZoomIn():g.wrap.css(c).animate(d,{duration:a.nextSpeed,easing:a.nextEasing,complete:g._afterZoomIn})},changeOut:function(){var a=g.previous,b=a.prevEffect,c={opacity:.1},d=g.direction,e=200;"elastic"===b&&(c["down"===d||"up"===d?"top":"left"]=("up"===d||"left"===d?"-":"+")+"="+e+"px"),a.wrap.animate(c,{duration:"none"===b?0:a.prevSpeed,easing:a.prevEasing,complete:function(){$(this).trigger("onReset").remove()}})}},g.helpers.overlay={defaults:{closeClick:!0,speedOut:200,showEarly:!0,css:{},locked:!j,fixed:!0},overlay:null,fixed:!1,el:$("html"),create:function(a){a=$.extend({},this.defaults,a),this.overlay&&this.close(),this.overlay=$('<div class="fancybox-overlay"></div>').appendTo(g.coming?g.coming.parent:a.parent),this.fixed=!1,a.fixed&&g.defaults.fixed&&(this.overlay.addClass("fancybox-overlay-fixed"),this.fixed=!0)},open:function(a){var b=this;a=$.extend({},this.defaults,a),this.overlay?this.overlay.unbind(".overlay").width("auto").height("auto"):this.create(a),this.fixed||(e.bind("resize.overlay",$.proxy(this.update,this)),this.update()),a.closeClick&&this.overlay.bind("click.overlay",function(a){return $(a.target).hasClass("fancybox-overlay")?(g.isActive?g.close():b.close(),!1):void 0}),this.overlay.css(a.css).show()},close:function(){var a,b;e.unbind("resize.overlay"),this.el.hasClass("fancybox-lock")&&($(".fancybox-margin").removeClass("fancybox-margin"),a=e.scrollTop(),b=e.scrollLeft(),this.el.removeClass("fancybox-lock"),e.scrollTop(a).scrollLeft(b)),$(".fancybox-overlay").remove().hide(),$.extend(this,{overlay:null,fixed:!1})},update:function(){var b,a="100%";this.overlay.width(a).height("100%"),h?(b=Math.max(document.documentElement.offsetWidth,document.body.offsetWidth),f.width()>b&&(a=f.width())):f.width()>e.width()&&(a=f.width()),this.overlay.width(a).height(f.height())},onReady:function(a,b){var c=this.overlay;$(".fancybox-overlay").stop(!0,!0),c||this.create(a),a.locked&&this.fixed&&b.fixed&&(c||(this.margin=f.height()>e.height()?$("html").css("margin-right").replace("px",""):!1),b.locked=this.overlay.append(b.wrap),b.fixed=!1),a.showEarly===!0&&this.beforeShow.apply(this,arguments)},beforeShow:function(a,b){var c,d;b.locked&&(this.margin!==!1&&($("*").filter(function(){return"fixed"===$(this).css("position")&&!$(this).hasClass("fancybox-overlay")&&!$(this).hasClass("fancybox-wrap")}).addClass("fancybox-margin"),this.el.addClass("fancybox-margin")),c=e.scrollTop(),d=e.scrollLeft(),this.el.addClass("fancybox-lock"),e.scrollTop(c).scrollLeft(d)),this.open(a)},onUpdate:function(){this.fixed||this.update()},afterClose:function(a){this.overlay&&!g.coming&&this.overlay.fadeOut(a.speedOut,$.proxy(this.close,this))}},g.helpers.title={defaults:{type:"float",position:"bottom"},beforeShow:function(a){var e,f,b=g.current,c=b.title,d=a.type;if($.isFunction(c)&&(c=c.call(b.element,b)),l(c)&&""!==$.trim(c)){switch(e=$('<div class="fancybox-title fancybox-title-'+d+'-wrap">'+c+"</div>"),d){case"inside":f=g.skin;break;case"outside":f=g.wrap;break;case"over":f=g.inner;break;default:f=g.skin,e.appendTo("body"),h&&e.width(e.width()),e.wrapInner('<span class="child"></span>'),g.current.margin[2]+=Math.abs(o(e.css("margin-bottom")))}e["top"===a.position?"prependTo":"appendTo"](f)}}},$.fn.fancybox=function(a){var b,c=$(this),d=this.selector||"",e=function(e){var i,j,f=$(this).blur(),h=b;e.ctrlKey||e.altKey||e.shiftKey||e.metaKey||f.is(".fancybox-wrap")||(i=a.groupAttr||"data-fancybox-group",j=f.attr(i),j||(i="rel",j=f.get(0)[i]),j&&""!==j&&"nofollow"!==j&&(f=d.length?$(d):c,f=f.filter("["+i+'="'+j+'"]'),h=f.index(this)),a.index=h,g.open(f,a)!==!1&&e.preventDefault())};return a=a||{},b=a.index||0,d&&a.live!==!1?f.undelegate(d,"click.fb-start").delegate(d+":not('.fancybox-item, .fancybox-nav')","click.fb-start",e):c.unbind("click.fb-start").bind("click.fb-start",e),this.filter("[data-fancybox-start=1]").trigger("click"),this},f.ready(function(){var a,b;void 0===$.scrollbarWidth&&($.scrollbarWidth=function(){var a=$('<div style="width:50px;height:50px;overflow:auto"><div/></div>').appendTo("body"),b=a.children(),c=b.innerWidth()-b.height(99).innerWidth();return a.remove(),c}),void 0===$.support.fixedPosition&&($.support.fixedPosition=function(){var a=$('<div style="position:fixed;top:20px;"></div>').appendTo("body"),b=20===a[0].offsetTop||15===a[0].offsetTop;return a.remove(),b}()),$.extend(g.defaults,{scrollbarWidth:$.scrollbarWidth(),fixed:$.support.fixedPosition,parent:$("body")}),a=$(window).width(),d.addClass("fancybox-lock-test"),b=$(window).width(),d.removeClass("fancybox-lock-test"),$("<style type='text/css'>.fancybox-margin{margin-right:"+(b-a)+"px;}</style>").appendTo("head")})});